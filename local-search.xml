<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>6 容斥原理及其应用</title>
    <link href="/2024/09/30/6-%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/"/>
    <url>/2024/09/30/6-%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="组合数学第五版答案-容斥原理及其应用"><a href="#组合数学第五版答案-容斥原理及其应用" class="headerlink" title="组合数学第五版答案-容斥原理及其应用"></a>组合数学第五版答案-容斥原理及其应用</h1><blockquote><p>Richard A. Brualdi-Introductory Combinatorics (5th Edition) (2009) 第六章的部分习题答案，直接套公式，书中有详细答案或与书中例题基本一致的题目省略。仅供参考。</p></blockquote><p>因本人水平有限，且没有标答验证，可能有错误，欢迎指正。</p><h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><blockquote><p>Find the number of integers between 1 and 10,000 that are neither perfect squares nor perfect cubes.</p></blockquote><p>如何找出既是完全平方数又是完全立方数的数？<br>注意到$x=a^2=b^3$ 那么$b=a^{\frac{2}{3}}$因此$a^{\frac{1}{3}}$为整数,那么$x=c^6$只需解$c^6\leq10000$即可。</p><h2 id="19"><a href="#19" class="headerlink" title="19"></a>19</h2><blockquote><p>Using the evaluation of the derangement numbers as given in Theorem 6.3.1, provide a proof of the relation</p><script type="math/tex; mode=display">D_n = (n-1)(D_{n-2} + D_{n-1}), \quad (n=3,4,5, ...).</script></blockquote><script type="math/tex; mode=display">\begin{aligned}(n-1)(D_{n-1}+D_{n-2})&=(n-1)\left((n-1)!\sum_{i=0}^{n-1}\frac{(-1)^i}{i!}+(n-2)!\sum_{i=0}^{n-2}\frac{(-1)^i}{i!} \right)\\&=(n-1)\left((n-1)!+(n-2)!\right)\sum_{i=0}^{n-2}\frac{(-1)^i}{i!}+(n-1)\cdot(-1)^{n-1}\\&=n!\sum_{i=0}^{n-2}\frac{(-1)^i}{i!}+n!\left(\frac{(-1)^{n-1}(n-1)}{n!} \right)\\&=n!\sum_{i=0}^{n-2}\frac{(-1)^i}{i!}+n!\left(\frac{(-1)^{n-1}n}{n!}-(-1)^{n-1}\frac{1}{n!} \right)\\&=D_n\end{aligned}</script><h2 id="21"><a href="#21" class="headerlink" title="21"></a>21</h2><blockquote><p>Prove that $D_n$ is an even number if and only if n is an odd number.</p></blockquote><p>可通过归纳法，或者：</p><p>可以根据</p><script type="math/tex; mode=display">D_n=n!\left(1-\frac{1}{1!}+\frac{1}{2!}-\frac{1}{3!}+\cdots+(-1)^n\frac{1}{n!}\right)</script><p>单独考虑$D_1$,然后</p><script type="math/tex; mode=display">D_n=(-1)^n \frac{n!}{n!} +(-1)^{n-1} \frac{n!}{(n-1)!}\cdots</script><p>当$n&gt;1$时，第三项后面项全是偶数，而第一项为奇数，第二项与n同奇偶，因此$D_n$为偶数，当且仅当$n$为奇数。</p><p>或者由于</p><script type="math/tex; mode=display">D_n=nD_{n-1}+(-1)^n</script><p>递推一步，可得出：</p><script type="math/tex; mode=display">D_{n+1}\equiv n(n+1)D_{n-1}+n \equiv n\mod{2}</script><h2 id="27"><a href="#27" class="headerlink" title="27"></a>27</h2><blockquote><p>A carousel has eight seats, each representing a different animal. Eight girls are seated on the carousel facing forward (each girl ooks at another girl’s back). In how many ways can the girls change seats so that each has a different girl in front of her? How does the problem change if all the seats are identical?</p></blockquote><p>记$A_i$表示排列$s_1s_2 \cdots s_8$中$s_i$面向$s_{i+1}$（其中$1 \le i \le 7$），$A_8$表示表示排列$s_1s_2 \cdots s_8$中$s_8$面向$s_1$。</p><p>单独考虑$s_8$对$s_1$的情况。</p><p>$|A_i|$：$7!+6!=8\times 6!$</p><p>$|A_iA_j|$：$6!+2\times 5!=8\times 5!$</p><p>$k$个相交为$(8-k)!+k\times(7-k)!=8\times (7-k)!$</p><p>答案为13000</p><p>当所有座位都相同时，第一个选择的只有1种选法，其余人选法不变，因此排列总数为$\frac{13000}{8} = 1625$。</p><h2 id="32"><a href="#32" class="headerlink" title="32"></a>32</h2><blockquote><p> Let n be a positive integer and let$p_1,p_2,\cdots,p_k$be all the different prime numbers that divide n. Consider the Euler function $\phi$ defined by </p><script type="math/tex; mode=display"> \phi(n)=|\{k:1 \leq k\leq n,GCD(k,n)=1 \}|</script><p> Use the inclusion-exclusion principle to show that </p><script type="math/tex; mode=display"> \phi(n)=n\prod_{i=1}^{k} (1-\frac{1}{p_i})</script></blockquote><p>设$A_i$为$p_i|\gcd(k,n)$的集合。</p><script type="math/tex; mode=display">\begin{aligned}\phi(n)&=|\overline{A_1}\cap \overline{A_2}\cap\cdots\cap \overline{A_k}|\\&=n-\sum_{i}\left(\frac{n}{p_i}\right)+\sum_{i,j}\left(\frac{n}{p_ip_j}\right)-\cdots+(-1)^k(\frac{n}{p_1p_2\cdots p_k})\\&=n\prod_{i=1}^{k} (1-\frac{1}{p_i})\end{aligned}</script><h2 id="33"><a href="#33" class="headerlink" title="33"></a>33</h2><blockquote><p><img src="6-容斥原理及其应用.assets/3508598-20240824231858132-1051765578.png" alt="image-20240824225321055"></p></blockquote><p>等价于从围成一圈的$1,2,\cdots,2n$选择不相邻的$m$个数字。我们选出分成$2n-k$和$k$，从$2n-k$中选出$k$个空，每一种选择可进行旋转，有$\frac{2n}{2n-k}$种。所以</p><script type="math/tex; mode=display">a(n,k)=\frac{2n}{2n-k} \binom{2n-k}{k}</script><p>或者：</p><p>若不考虑$1，2n$，我们可以假设选择$c_1,c_2,\cdots,c_k$，其中小于$c_i$的有$x_i$个，大于$c_k$的有$x_{k+1}$个。那么我们有</p><script type="math/tex; mode=display">x_1+x_2+\cdots +x_{k+1}=2n-k</script><p>然后先在两两中间插入一个，转化为</p><script type="math/tex; mode=display">y_1+y_2+\cdots+y_{k+1}=2n-2k+1</script><p>其中$0\leq y_i\leq 2n-2k+1$ ，有$\binom{2n-k+1}{k}$</p><p>假设选择$2n$，那么 不能选择$1,2n-1$,有$\binom{2n-k-1}{k-1}$</p><p>若不选择$2n$，那么有$\binom{2n-k}{k}$</p><p>总数为</p><script type="math/tex; mode=display">\binom{2n-k-1}{k-1}+\binom{2n-k}{k}=\frac{k}{2n-k}\binom{2n-k}{k}+\binom{2n-k}{k}=\frac{2n}{2n-k} \binom{2n-k}{k}</script><blockquote><p>不知道为什么棋盘和下面的等价，带入k=1，显然是错的，可能是这些位置不是禁止，而是其他位置禁止，那么就显然等价了。</p><p>我们可以进行编号。例如：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">1200</span><br><span class="hljs-number">0340</span><br><span class="hljs-number">0056</span><br><span class="hljs-number">8007</span><br></code></pre></td></tr></table></figure></blockquote><h2 id="34"><a href="#34" class="headerlink" title="34"></a>34</h2><blockquote><p><img src="6-容斥原理及其应用.assets/3508598-20240824231900606-1125738650.png" alt="image-20240824225329592"></p></blockquote><p>交换求和次序即可。</p><script type="math/tex; mode=display">\begin{aligned}f*(g*h)(x,y)&=\sum_{x\leq z\leq y}f(x,z)(g*h)(z,y)\\&=\sum_{x\leq z\leq y}\left( f(x,z)\left(\sum_{z\leq w\leq y}g(z,w)h(w,y) \right)\right)\\&=\sum_{x\leq z\leq y} \left(\sum_{z\leq w\leq y}f(x,z)g(z,w)h(w,y) \right)\\&=\sum_{x\leq w\leq y}\left(\sum_{x\leq z\leq w}f(x,z)g(z,w) \right)h(w,y)\\&=\sum_{x\leq w\leq y}(f*g)(x,w)h(w,y)\\&=(f*g)*h\end{aligned}</script><h2 id="36"><a href="#36" class="headerlink" title="36"></a>36</h2><blockquote><p><img src="6-容斥原理及其应用.assets/3508598-20240824231902977-1180121559.png" alt="image-20240824225335976"></p></blockquote><p>代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a[<span class="hljs-number">30</span>][<span class="hljs-number">30</span>];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span> </span>&#123;<br>  <span class="hljs-type">int</span> n;<br>  cin &gt;&gt; n;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; ++j) &#123;<br>      cin &gt;&gt; a[i][j];<br>    &#125;<br>  &#125;<br>  ll ans = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; (<span class="hljs-number">1ll</span> &lt;&lt; n); ++i) &#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; S;<br>    <span class="hljs-comment">// subset S</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; n; ++j) &#123;<br>      <span class="hljs-keyword">if</span> (i &gt;&gt; j &amp; <span class="hljs-number">1</span>) &#123;<br>        S.<span class="hljs-built_in">push_back</span>(j + <span class="hljs-number">1</span>);<br>      &#125;<br>    &#125;<br>    ll p = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; ++k) &#123;<br>      ll sum = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; x : S) sum += a[k][x];<br>      p *= sum;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ((n - S.<span class="hljs-built_in">size</span>()) &amp; <span class="hljs-number">1</span>) &#123;<br>      ans -= p;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      ans += p;<br>    &#125;<br>  &#125;<br>  cout &lt;&lt; ans;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="37"><a href="#37" class="headerlink" title="37"></a>37</h2><blockquote><p><img src="6-容斥原理及其应用.assets/3508598-20240824231905649-526507169.png" alt="image-20240824225341561"></p></blockquote><p>赋值法。</p><p>设$f*g=\delta$</p><script type="math/tex; mode=display">\delta(A,B)=\sum_{A\subseteq C \subseteq B} f(A,C) g(C,B)</script><ul><li><p>若$A=B$：</p><p>那么</p><script type="math/tex; mode=display">f(A,A)g(A,A)=1\Rightarrow g(A,A)=1</script><p>$g(A,B)=1$</p></li><li><p>若$|B|-|A|=1$</p><p>那么</p><script type="math/tex; mode=display">\begin{aligned}0&=f(A,A)g(A,B)+f(A,B)g(B,B)\\&=g(A,B)+2\end{aligned}</script><p>$g(A,B)=-2$</p></li><li><p>若$|B|-|A|=2$</p><p>那么</p><script type="math/tex; mode=display">\begin{aligned}0&=f(A,A)g(A,B)+f(A,C)g(C,B)+f(A,B)g(B,B) \\&=g(A,B)+2g(C,B)+1\\&=g(A,B)-4+1\end{aligned}</script><p>$g(A,B)=3$</p></li><li><p>若$|B|-|A|=3$</p><p>那么</p><script type="math/tex; mode=display">\begin{aligned}0&=f(A,A)g(A,B)+f(A,C)g(C,B)+f(A,D)g(D,B)+f(A,B)g(B,B) \\&=g(A,B)+2g(C,B)+g(D,B)-1 \\&=g(A,B)+6-2-1\\\end{aligned}</script><p>$g(A,B)=-3$</p></li></ul><p>综上</p><p>若$A\subseteq B$</p><script type="math/tex; mode=display">g(A,B)=\begin{cases}1&\qquad,A=B\\-2&\qquad,|B|-|A|=1\\3&\qquad,|B|-|A|=2\\-3&\qquad,|B|-|A|=3\end{cases}</script><h2 id="38"><a href="#38" class="headerlink" title="38"></a>38</h2><blockquote><p><img src="6-容斥原理及其应用.assets/3508598-20240824231910809-1937170535.png" alt="image-20240824225346059"></p></blockquote><p>以$\Pi_3$为例：</p><script type="math/tex; mode=display">\begin{aligned}\sigma_1&=\{\{ 1,2,3\}\}\\\sigma_2&=\{\{ 1\},\{ 2,3\}\}\\\sigma_3&=\{\{ 1,2\},\{ 3\}\}\\\sigma_4&=\{\{ 1,3\},\{ 2\}\}\\\sigma_5&=\{\{ 1\},\{ 2\},\{3\}\}\\\end{aligned}</script><ul><li><p>若$|\sigma|-|\pi|=1$</p><script type="math/tex; mode=display">\begin{aligned}\mu(\sigma,\pi)=-\left(\mu(\sigma,\sigma )\right)=-1\end{aligned}</script></li><li><p>若$|\sigma|-|\pi|=2$</p><script type="math/tex; mode=display">\mu(\sigma,\pi)=-\left(\mu(\sigma,\sigma )+\mu(\sigma,\sigma_2)+\mu(\sigma,\sigma_3)+\mu(\sigma,\sigma_4) \right)=-(1-3)=2</script></li></ul><h2 id="39"><a href="#39" class="headerlink" title="39"></a>39</h2><blockquote><p><img src="6-容斥原理及其应用.assets/3508598-20240824231913988-326576119.png" alt="image-20240824225352287"></p></blockquote><p>等价于证明$\forall a\in X_n, \mu(1,k)=\mu(a,ka)$对任意正整数成立(满足$ka\leq n$)</p><p>考虑使用数学归纳法</p><ul><li><p>$k=1$,显然成立</p></li><li><p>假设对于任意$x\leq t-1$成立。</p><script type="math/tex; mode=display">\begin{aligned}\mu(1,t)&=-\sum_{x|t,x<t}\mu(1,x)\\&=-\sum_{x|t,x<t}\mu(a,xa)\\&=\mu(a,ta)\end{aligned}</script></li></ul><p>证毕。</p><h2 id="40"><a href="#40" class="headerlink" title="40"></a>40</h2><blockquote><p><img src="6-容斥原理及其应用.assets/image-20240824225358425.png" alt="image-20240824225358425"></p></blockquote><p>这里略过证明偏序关系的过程。</p><p>这个偏序集是$k$个线性有序集的笛卡尔积。因此可以得到</p><p>设$A=p_i\cdot a_i$，$B=q_i\cdot a_i$，$A\leq B$，$m=\max_{1\leq i \leq k}{(q_i-p_i)}$，$c=\sum_{1\leq i\leq k}[q_i-p_i=1]$</p><script type="math/tex; mode=display">\mu(A,B)=\begin{cases}1&\qquad,m=0\\(-1)^c&\qquad,m=1\\0&\qquad,m>1\end{cases}</script>]]></content>
    
    
    
    <tags>
      
      <tag>组合数学</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
