<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>5thCombinatorics7</title>
    <link href="/2024/10/01/5thCombinatorics7/"/>
    <url>/2024/10/01/5thCombinatorics7/</url>
    
    <content type="html"><![CDATA[<h1 id="递推关系和生成函数">递推关系和生成函数</h1><h2 id="section">1</h2><blockquote><figure><img src="/images/image-20240909140350501.png"alt="image-20240909140350501" /><figcaption aria-hidden="true">image-20240909140350501</figcaption></figure></blockquote><h3 id="d">d</h3><p><span class="math display">\[\begin{aligned}\sum_{i=0}^{n} f_i^2&amp;=f_0^2+\sum_{i=1}^{n}f_i^2\\&amp;=f_0f_1+\left(f_1(f_2-f_0)+f_2(f_3-f_1)+\cdots+f_n(f_{n+1}-f_{n-1})\right)\\&amp;=f_nf_{n+1}\end{aligned}\]</span></p><h2 id="section-1">2</h2><blockquote><figure><img src="/images/image-20240909140828646.png"alt="image-20240909140828646" /><figcaption aria-hidden="true">image-20240909140828646</figcaption></figure></blockquote><p>容易想到证明<spanclass="math inline">\(f_n\)</span>与上式差值绝对值小于<spanclass="math inline">\(\frac{1}{2}\)</span> <span class="math display">\[\begin{aligned}\left |f_n-\frac{1}{\sqrt{5}} {\left( \frac{1+\sqrt{5}}{2} \right)^n}\right|&amp;=\left|\frac{1}{\sqrt{5}} {\left( \frac{1-\sqrt{5}}{2}\right)}^n \right| \\&amp;=\frac{1}{\sqrt{5}}\left(\frac{2}{\left(1+\sqrt{5} \right)}\right)^n\\&amp;&lt;\frac{1}{\sqrt{5}}\\&amp;&lt;\frac{1}{2}\end{aligned}\]</span></p><h2 id="section-2">3</h2><blockquote><figure><img src="/images/image-20240909141704032.png"alt="image-20240909141704032" /><figcaption aria-hidden="true">image-20240909141704032</figcaption></figure></blockquote><h3 id="b">b</h3><p><span class="math display">\[f_n=3f_{n-3}+2f_{n-4}\equiv 2f_{n-4} \mod{3}\]</span></p><p>因此 <span class="math display">\[3|f_n\iff 3|f_{n-4}\]</span></p><h3 id="c">c</h3><p>我们对斐波拉契数列 取模有 <span class="math display">\[0,1,1,2,3,1,0,1,\cdots\]</span> 发现其以<span class="math inline">\(6\)</span>为周期循环。</p><h2 id="section-3">6</h2><blockquote><figure><img src="/images/image-20240910155854537.png"alt="image-20240910155854537" /><figcaption aria-hidden="true">image-20240910155854537</figcaption></figure></blockquote><p>我们令 <span class="math display">\[f_n=a_xf_{n-x}+b_xf_{n-x-1}\]</span> 显然有 <span class="math display">\[b_n=a_{n-1}\]</span> 且 <span class="math display">\[a_n=a_{n-1}+b_{n-1}=a_{n-1}+a_{n-2}\Rightarrow b_n=b_{n-1}+b_{n-2}\]</span></p><p>又<span class="math inline">\(b_0=0,b_1=1\)</span>故<spanclass="math inline">\(b\)</span>是斐波拉契数列。</p><p>那么有 <span class="math display">\[f_n=f_{x+1}f_{n-x}+f_xf_{n-x-1}\]</span> 设<spanclass="math inline">\(n=km\)</span>，用数学归纳法即可。</p><h2 id="section-4">7</h2><blockquote><figure><img src="/images/image-20240910160533931.png"alt="image-20240910160533931" /><figcaption aria-hidden="true">image-20240910160533931</figcaption></figure></blockquote><p>设<span class="math inline">\(n=km+r\)</span> ，</p><p>那么有 <span class="math display">\[f_n=f_{r+1}f_{km}+f_rf_{km-1}\]</span> 注意到 <span class="math display">\[\gcd(f_n,f_{n+1}) =1\]</span> 我们有 <span class="math display">\[f_{km-1}=f_mf_{(k-1)m}+f_{m-1}f_{(k-1)m-1}\]</span></p><p>从而有 <span class="math display">\[\gcd(f_{km-1},f_m)=\gcd(f_m,f_{m-1})=1\]</span> 故 <span class="math display">\[\gcd(f_n,f_m)=\gcd(f_m,f_r)\]</span> 然后令n=m，m=r。类比欧几里得算法。可得 <spanclass="math display">\[\gcd(f_n,f_m)=f_{\gcd(n,m)}\]</span></p><h2 id="section-5">9</h2><blockquote><figure><img src="/images/image-20240910165450019.png"alt="image-20240910165450019" /><figcaption aria-hidden="true">image-20240910165450019</figcaption></figure></blockquote><p>有 <span class="math display">\[h_n=2(h_{n-1}+h_{n-2})\]</span> 特征方程<span class="math inline">\(x^2-2x-2=0\)</span>的根为<span class="math display">\[x=1\pm\sqrt{3}\]</span> 初值为<span class="math inline">\(h_0=1,h_1=3\)</span></p><p>带入得 <span class="math display">\[\begin{cases}c_1+c_2=1\\c_1(1+\sqrt{3})+c_2(1-\sqrt{3})=3\end{cases}\]</span> 解得 <span class="math display">\[c_1=\frac{3+2\sqrt{3}}{6}(1+\sqrt{3})^n+\frac{3-2\sqrt{3}}{6}(1-\sqrt{3})^n\]</span></p><h2 id="section-6">15</h2><blockquote><figure><img src="/images/image-20240910170155353.png"alt="image-20240910170155353" /><figcaption aria-hidden="true">image-20240910170155353</figcaption></figure></blockquote><p>有 <span class="math display">\[\frac{1}{1-x}=\sum_{n=0}^{\infty}x^n\]</span> 同时微分并乘<span class="math inline">\(x\)</span> <spanclass="math display">\[\frac{x}{(1-x)^2}=\sum_{n=0}^{\infty}nx^n\]</span> 同时微分并乘<span class="math inline">\(x\)</span> <spanclass="math display">\[\frac{x-x^3}{(1-x)^4}=\sum_{n=0}^{\infty}n^2x^n\]</span> 同时微分并乘<span class="math inline">\(x\)</span> <spanclass="math display">\[\frac{x^3+4x^2+x}{(1-x)^4}=\sum_{n=0}^{\infty}n^3x^n\]</span> 或者由 <span class="math display">\[n^3 = 6 \binom{n}{3} + 6 \binom{n}{2} + \binom{n}{1}\]</span> 得 <span class="math display">\[\begin{aligned}g(x)&amp;=\sum_{n=0}^{\infty}6\binom{n}{3}x^n+\sum_{n=0}^{\infty}6\binom{n}{2}x^n+\sum_{n=0}^{\infty} \binom{n}{1}x^n\\&amp;=6x^3\sum_{n=0}^{\infty}\binom{n+3}{n}x^n+6x^2\sum_{n=0}^{\infty}\binom{n+2}{n}x^n+x\sum_{n=0}^{\infty}\binom{n+1}{n}x^n\\&amp;=\frac{6x^3}{(1-x)^4}+\frac{6x^2}{(1-x)^3}+\frac{x}{(1-x)^2}\\&amp;=\frac{x^3+4x^2+x}{(1-x)^4}\end{aligned}\]</span></p><h2 id="section-7">21</h2><blockquote><figure><img src="/images/image-20240911135029474.png"alt="image-20240911135029474" /><figcaption aria-hidden="true">image-20240911135029474</figcaption></figure></blockquote><p>设该<span class="math inline">\(n+2\)</span>边形其中一个顶点为<spanclass="math inline">\(v\)</span>，我们连接其左右两个顶点后形成一个<spanclass="math inline">\(n+1\)</span>边形。然后设其连出去的<spanclass="math inline">\(n-1\)</span>条对角线分别产生<spanclass="math inline">\(k_i\)</span>个交点。那么将新产生<spanclass="math inline">\(k_i+1\)</span>个区域。因此答案为 <spanclass="math display">\[h_n=h_{n-1}+1+\sum_{i=1}^{n-1}(k_i+1)=h_{n-1}+n+\sum_{i=1}^{n-1}k_i\]</span> 而事实上<span class="math inline">\(k_i\)</span>的和就是<spanclass="math inline">\(n+2\)</span>边形的对角线产生的非顶点的交点数与<spanclass="math inline">\(n+1\)</span>边形的差。</p><p><strong>引理</strong>：而对于一个<spanclass="math inline">\(n\)</span>边形不考虑共点和顶点的情况下，将产生<spanclass="math inline">\(\binom{n}{4}\)</span>的交点。</p><p><strong>证明：</strong>对于四个顶点，我们连完对角线将产生一个交点，而任意一个交点，将对应四个顶点。因此交点数和从<spanclass="math inline">\(n\)</span>个顶点选出4个点是一一对应的。证毕。</p><p>故上式等于 <span class="math display">\[\begin{aligned}h_n&amp;=h_{n-1}+n+\sum_{i=1}^{n-1}k_i\\&amp;=h_{n-1}+\binom{n+2}{4}-\binom{n+1}{4}+n\\&amp;=h_{n-1}+\binom{n+1}{3}+n\end{aligned}\]</span> 有 <span class="math display">\[\begin{aligned}(1-x)g(x)&amp;=h_0+\sum_{n=1}^{\infty}\left(\binom{n+1}{3}+n\right)x^{n}\\&amp;=\sum_{n=1}^{\infty}\binom{n+1}{3}x^n+\sum_{n=1}^{\infty}nx^n\\&amp;=x^2\sum_{n=0}^{\infty}\binom{n+3}{3}x^n+\sum_{n=0}^{\infty} nx^n\\&amp;=\frac{x^2}{(1-x)^4}+\frac{x}{(1-x)^2}\\\end{aligned}\]</span> 从而 <span class="math display">\[\begin{aligned}g(x)&amp;=\frac{x^2}{(1-x)^5}+\frac{x}{(1-x)^3}\\&amp;=x^2\sum_{n=0}^{\infty}\binom{n+4}{n}x^n+x\sum_{n=0}^{\infty}\binom{n+2}{n}x^n\\&amp;=\sum_{n=0}^{\infty}\binom{n+2}{4}x^n+\sum_{n=0}^{\infty}\binom{n+1}{2}x^n\\&amp;=\sum_{n=0}^{\infty}\left(\binom{n+2}{4}+\binom{n+1}{2} \right)x^n\end{aligned}\]</span> 综上 <span class="math display">\[h_n=\binom{n+2}{4}+\binom{n+1}{2}\]</span> 或者考虑迭代法</p><h2 id="section-8">25</h2><blockquote><figure><img src="/images/image-20240914213455922.png"alt="image-20240914213455922" /><figcaption aria-hidden="true">image-20240914213455922</figcaption></figure></blockquote><p>使用生成函数： <span class="math display">\[\begin{aligned}g(x)&amp;=\left(\sum_{n=0}^{\infty}\frac{x^n}{n!}\right)^2\left(1+\frac{x^2}{2!}+\cdots\right)\left(x+\frac{x^3}{3!}+\cdots \right)\\&amp;=e^{2x}\left(\frac{e^x+e^{-x}}{2} \right) \left(\frac{e^x-e^{-x}}{2} \right)\\&amp;=\frac{e^{4x}-1}{4}\\&amp;=\frac{1}{4}\sum_{n=0}^{\infty} 4^{n} \frac{x^n}{n!}-\frac{1}{4}\\&amp;=\sum_{n=1}^{\infty} 4^{n-1} \frac{x^n}{n!}\end{aligned}\]</span> 故 <span class="math display">\[h_n=4^{n-1}(n\geq 1)\]</span> 特别地：<span class="math inline">\(h_0=1\)</span></p><h2 id="section-9">29</h2><blockquote><figure><img src="/images/image-20240920143718421.png"alt="image-20240920143718421" /><figcaption aria-hidden="true">image-20240920143718421</figcaption></figure></blockquote><p>设<span class="math inline">\(a_n\)</span>为<spanclass="math inline">\(1,3\)</span>均出现奇数次时的数，且<spanclass="math inline">\(b_n\)</span>为一奇一偶。</p><p>那么有 <span class="math display">\[\begin{cases}a_n=3a_{n-1}+2b_{n-1}\\b_n=3b_{n-1}+a_{n-1}+h_{n-1}\\h_n=3h_{n-1}+2b_{n-1}\\a_n+2b_n+h_n=5^n\end{cases}\]</span> 消元可得到<span class="math inline">\(h_n\)</span>的递推式<span class="math display">\[h_n-4h_{n-1}+3h_{n-2}=2\cdot5^{n-2}\]</span> 其齐次递推式的特征方程为 <span class="math display">\[x^2-4x+3=0\]</span> 从而求出解 <span class="math display">\[H_n=c_13^n+c_2\]</span> 下面求一个特解，设<spanclass="math inline">\(h_n=p5^n\)</span>，解得<spanclass="math inline">\(p=\frac{1}{4}\)</span>。</p><p>那么 <span class="math display">\[h_n=c_13^n+c_2+\frac{5^n}{4}\]</span> 带入<span class="math inline">\(h_0,h_1\)</span>得 <spanclass="math display">\[h_n=\frac{2\cdot 3^n+1+5^n}{4}\]</span> 或者根据递推式，利用生成函数： <span class="math display">\[\begin{aligned}(1-4x+3x^2)g(x)&amp;=1-x+\sum_{n=2}^{\infty}2\cdot5^{n-2}x^n\\&amp;=1-x+2x^2\sum_{n=0}^{\infty}(5x)^n\\&amp;=1-x+\frac{2x^2}{1-5x}\end{aligned}\]</span> 那么 <span class="math display">\[\begin{aligned}g(x)&amp;=\frac{1-x}{1-4x+3x^2}+\frac{2x^2}{(1-5x)(1-4x+3x^2)}\\&amp;=\frac{1}{1-3x}+\frac{\frac{1}{4}}{1-5x}-\frac{\frac{1}{2}}{1-3x}+\frac{\frac{1}{4}}{1-x}\\&amp;=\frac{1}{2}\sum_{n=0}^{\infty}3^nx^n+\frac{1}{4}\sum_{n=0}^{\infty}5^nx^n+\frac{1}{4}\sum_{n=0}^{\infty}x^n\\&amp;=\sum_{n=0}^{\infty}\left(\frac{5^n+2\cdot3^n+1}{4} \right)x^n\end{aligned}\]</span> 故 <span class="math display">\[h_n=\frac{5^n+2\cdot3^n+1}{4}\]</span></p><h2 id="section-10">37</h2><blockquote><figure><img src="/images/image-20240924154940086.png"alt="image-20240924154940086" /><figcaption aria-hidden="true">image-20240924154940086</figcaption></figure></blockquote><p>为了计算<spanclass="math inline">\(a_n\)</span>我们不妨将其分成以<spanclass="math inline">\(22\)</span>开头的和其他，若以<spanclass="math inline">\(22\)</span>开头显然有<spanclass="math inline">\(a_{n-2}\)</span> 种，否则我们再将<spanclass="math inline">\(a_{n-1}\)</span>分成三类，开头为<spanclass="math inline">\(0,1,2\)</span></p><p>设其分别有<span class="math inline">\(x,y,z\)</span>种。</p><p>那么有 <span class="math display">\[a_n=(y+z)+(x+z)+(x+y)+a_{n-2}=2a_{n-1}+a_{n-2}\]</span></p><h2 id="section-11">41</h2><blockquote><figure><img src="/images/image-20240924154950797.png"alt="image-20240924154950797" /><figcaption aria-hidden="true">image-20240924154950797</figcaption></figure></blockquote><p>我们不妨对这<spanclass="math inline">\(2n\)</span>个点编号，若我们先连接<spanclass="math inline">\(1,x\)</span>，显然<spanclass="math inline">\(2|x\)</span>，且满足递推式 <spanclass="math display">\[h_n=\sum_{k=1}^{n}h_{k-1}h_{n-k}\]</span> 为卡特兰序列。</p><p>故 <span class="math display">\[h_n=\frac{1}{n+1} \binom{2n}{n}\]</span></p><h2 id="section-12">49</h2><blockquote><figure><img src="/images/image-20240929111735871.png"alt="image-20240929111735871" /><figcaption aria-hidden="true">image-20240929111735871</figcaption></figure></blockquote><p><strong>公式似乎有错</strong>，应该是 <span class="math display">\[(x+y)(x+qy)\cdots(x+q^{m-1}y)=\sum_{k=0}^{n}q^{\binom{k}{2}}\binom{n}{k}_qx^{n-k}y^k\]</span></p><p>注意到： <span class="math display">\[\binom{n}{k}_q=\prod_{i=1}^{k}\frac{1-q^{n-k+i}}{1-q^i}\]</span> 因此： <span class="math display">\[\binom{n}{k}_q=\frac{1-q^n}{1-q^{n-k}}\binom{n-1}{k}_q\\\binom{n}{k}_q=\frac{1-q^n}{1-q^k}\binom{n-1}{k-1}_q\]</span> 故 <span class="math display">\[\begin{aligned}q^k\binom{n}{k}_q+\binom{n}{k-1}_q&amp;=q^k\frac{1-q^{n+1-k}}{1-q^{n+1}}\binom{n+1}{k}+\frac{1-q^k}{1-q^{n+1}}\binom{n+1}{k}\\&amp;=\left(\frac{q^k-q^{n+1}+1-q^{k}}{1-q^{n+1}}\right)\binom{n+1}{k}\\&amp;=\binom{n+1}{k}\end{aligned}\]</span></p><p>同理可得 <span class="math display">\[\binom{n}{k}+q^{n+1-k}\binom{n}{k-1}=\binom{n+1}{k}\]</span></p><p>显然可以用数学归纳法证明：</p><p><span class="math inline">\(n=1\)</span>显然。</p><p>设<span class="math inline">\(n=m\)</span>成立，那么当<spanclass="math inline">\(n=m+1\)</span>时，有： <spanclass="math display">\[\begin{aligned}&amp;(x+y)(x+qy)\cdots(x+q^{m-1}y)(x+q^my)\\&amp;=(x+q^my)\sum_{k=0}^{m}q^{\binom{k}{2}} \binom{m}{k}_qx^{m-k}y^k\\&amp;=\sum_{k=0}^{m}q^{\binom{k}{2}}\binom{m}{k}_qx^{m+1-k}y^k+\sum_{k=1}^{m+1}q^{\binom{k-1}{2}}q^m\binom{m}{k-1}_qx^{m+1-k}y^k\\&amp;=\binom{m}{0}_qx^{m+1} +\sum_{k=1}^{m}\left(\left(q^{\binom{k}{2}}\binom{m}{k}_q+q^{\binom{k-1}{2}+m} \binom{m}{k-1}_q\right)x^{m+1-k}y^k\right)+q^{\binom{m}{2}+\binom{m}{1}} \binom{m}{m}_qy^{m+1}\\&amp;=\binom{m+1}{0}_qx^{m+1}+\sum_{k=1}^{m}\left(q^{\binom{k}{2}}\left(\binom{m}{k}_q+q^{m+1-k}\binom{m}{k-1}_q \right)x^{m+1-k}y^k\right)+q^{\binom{m+1}{2}}y^{m+1}\\&amp;=\sum_{k=0}^{m+1}q^{\binom{k}{2}}\binom{m+1}{k}_qx^{m+1-k}y^k\end{aligned}\]</span> 证毕。</p><h2 id="section-13">50</h2><blockquote><p><img src="/images/image-20240929131531914.png"alt="image-20240929131531914" /> <imgsrc="/images/image-20240929131603989.png"alt="image-20240929131603989" /></p></blockquote><p>有 <span class="math display">\[\begin{aligned}g_n&amp;=\sum_{k=1}^{n} \binom{n-k}{k-1}\\&amp;=\sum_{k=1}^{n}\binom{n-k-1}{k-1}+\sum_{k=1}^{n}\binom{n-k-1}{k-2}\\&amp;=\sum_{k=1}^{n-1}\binom{n-1-k}{k-1}+\sum_{k=1}^{n}\binom{n-2-(k-1)}{k-1-1}\\&amp;=g_{n-1}+\sum_{k=0}^{n-1}\binom{n-2-k}{k-1}\\&amp;=g_{n-1}+\sum_{k=1}^{n-2}\binom{n-2-k}{k-1}\\&amp;=g_{n-1}+g_{n-2}\end{aligned}\]</span></p><h2 id="section-14">51</h2><blockquote><figure><img src="/images/image-20240929134343436.png"alt="image-20240929134343436" /><figcaption aria-hidden="true">image-20240929134343436</figcaption></figure></blockquote><p>有 <span class="math display">\[(1-3x)g(x)=2-4\sum_{n=1}^{\infty}nx^n\]</span> 故 <span class="math display">\[\begin{aligned}g(x)&amp;=\frac{2}{1-3x}-\frac{4}{1-3x} \sum_{n=1}^{\infty}nx^n\\&amp;=\frac{2}{1-3x}-\frac{4x}{1-3x}\sum_{n=0}^{\infty}\binom{n+1}{n}x^n\\&amp;=\frac{2}{1-3x}-\frac{4x}{1-3x}\frac{1}{(1-x)^2}\\&amp;=\frac{-1}{1-3x} + \frac{3-x}{(1-x)^2} \\&amp;=\sum_{n=0}^{\infty} (2n+3-3^n)x^n\end{aligned}\]</span></p>]]></content>
    
    
    
    <tags>
      
      <tag>combinatorics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>5thCombinatorics6</title>
    <link href="/2024/09/30/5thCombinatorics6/"/>
    <url>/2024/09/30/5thCombinatorics6/</url>
    
    <content type="html"><![CDATA[<h1id="组合数学第五版答案-容斥原理及其应用">组合数学第五版答案-容斥原理及其应用</h1><blockquote><p>Richard A. Brualdi-Introductory Combinatorics (5th Edition) (2009)第六章的部分习题答案，直接套公式，书中有详细答案或与书中例题基本一致的题目省略。仅供参考。</p></blockquote><p>因本人水平有限，且没有标答验证，可能有错误，欢迎指正。</p><h2 id="section">3</h2><blockquote><p>Find the number of integers between 1 and 10,000 that are neitherperfect squares nor perfect cubes.</p></blockquote><p>如何找出既是完全平方数又是完全立方数的数？ 注意到<spanclass="math inline">\(x=a^2=b^3\)</span> 那么<spanclass="math inline">\(b=a^{\frac{2}{3}}\)</span>因此<spanclass="math inline">\(a^{\frac{1}{3}}\)</span>为整数,那么<spanclass="math inline">\(x=c^6\)</span>只需解<spanclass="math inline">\(c^6\leq10000\)</span>即可。</p><h2 id="section-1">19</h2><blockquote><p>Using the evaluation of the derangement numbers as given in Theorem6.3.1, provide a proof of the relation</p><p><span class="math display">\[D_n = (n-1)(D_{n-2} + D_{n-1}), \quad (n=3,4,5, ...).\]</span></p></blockquote><p><span class="math display">\[\begin{aligned}(n-1)(D_{n-1}+D_{n-2})&amp;=(n-1)\left((n-1)!\sum_{i=0}^{n-1}\frac{(-1)^i}{i!}+(n-2)!\sum_{i=0}^{n-2}\frac{(-1)^i}{i!}\right)\\&amp;=(n-1)\left((n-1)!+(n-2)!\right)\sum_{i=0}^{n-2}\frac{(-1)^i}{i!}+(n-1)\cdot(-1)^{n-1}\\&amp;=n!\sum_{i=0}^{n-2}\frac{(-1)^i}{i!}+n!\left(\frac{(-1)^{n-1}(n-1)}{n!}\right)\\&amp;=n!\sum_{i=0}^{n-2}\frac{(-1)^i}{i!}+n!\left(\frac{(-1)^{n-1}n}{n!}-(-1)^{n-1}\frac{1}{n!}\right)\\&amp;=D_n\end{aligned}\]</span></p><h2 id="section-2">21</h2><blockquote><p>Prove that <span class="math inline">\(D_n\)</span> is an even numberif and only if n is an odd number.</p></blockquote><p>可通过归纳法，或者：</p><p>可以根据 <span class="math display">\[D_n=n!\left(1-\frac{1}{1!}+\frac{1}{2!}-\frac{1}{3!}+\cdots+(-1)^n\frac{1}{n!}\right)\]</span> 单独考虑<span class="math inline">\(D_1\)</span>,然后 <spanclass="math display">\[D_n=(-1)^n \frac{n!}{n!} +(-1)^{n-1} \frac{n!}{(n-1)!}\cdots\]</span> 当<spanclass="math inline">\(n&gt;1\)</span>时，第三项后面项全是偶数，而第一项为奇数，第二项与n同奇偶，因此<spanclass="math inline">\(D_n\)</span>为偶数，当且仅当<spanclass="math inline">\(n\)</span>为奇数。</p><p>或者由于 <span class="math display">\[D_n=nD_{n-1}+(-1)^n\]</span> 递推一步，可得出： <span class="math display">\[D_{n+1}\equiv n(n+1)D_{n-1}+n \equiv n\mod{2}\]</span></p><h2 id="section-3">27</h2><blockquote><p>A carousel has eight seats, each representing a different animal.Eight girls are seated on the carousel facing forward (each girl ooks atanother girl's back). In how many ways can the girls change seats sothat each has a different girl in front of her? How does the problemchange if all the seats are identical?</p></blockquote><p>记<span class="math inline">\(A_i\)</span>表示排列<spanclass="math inline">\(s_1s_2 \cdots s_8\)</span>中<spanclass="math inline">\(s_i\)</span>面向<spanclass="math inline">\(s_{i+1}\)</span>（其中<spanclass="math inline">\(1 \le i \le 7\)</span>），<spanclass="math inline">\(A_8\)</span>表示表示排列<spanclass="math inline">\(s_1s_2 \cdots s_8\)</span>中<spanclass="math inline">\(s_8\)</span>面向<spanclass="math inline">\(s_1\)</span>。</p><p>单独考虑<span class="math inline">\(s_8\)</span>对<spanclass="math inline">\(s_1\)</span>的情况。</p><p><span class="math inline">\(|A_i|\)</span>：<spanclass="math inline">\(7!+6!=8\times 6!\)</span></p><p><span class="math inline">\(|A_iA_j|\)</span>：<spanclass="math inline">\(6!+2\times 5!=8\times 5!\)</span></p><p><span class="math inline">\(k\)</span>个相交为<spanclass="math inline">\((8-k)!+k\times(7-k)!=8\times (7-k)!\)</span></p><p>答案为13000</p><p>当所有座位都相同时，第一个选择的只有1种选法，其余人选法不变，因此排列总数为<spanclass="math inline">\(\frac{13000}{8} = 1625\)</span>。</p><h2 id="section-4">32</h2><blockquote><p>Let n be a positive integer and let<spanclass="math inline">\(p_1,p_2,\cdots,p_k\)</span>be all the differentprime numbers that divide n. Consider the Euler function <spanclass="math inline">\(\phi\)</span> defined by <spanclass="math display">\[\phi(n)=|\{k:1 \leq k\leq n,GCD(k,n)=1 \}|\]</span> Use the inclusion-exclusion principle to show that <spanclass="math display">\[\phi(n)=n\prod_{i=1}^{k} (1-\frac{1}{p_i})\]</span></p></blockquote><p>设<span class="math inline">\(A_i\)</span>为<spanclass="math inline">\(p_i|\gcd(k,n)\)</span>的集合。 <spanclass="math display">\[\begin{aligned}\phi(n)&amp;=|\overline{A_1}\cap \overline{A_2}\cap\cdots\cap\overline{A_k}|\\&amp;=n-\sum_{i}\left(\frac{n}{p_i}\right)+\sum_{i,j}\left(\frac{n}{p_ip_j}\right)-\cdots+(-1)^k(\frac{n}{p_1p_2\cdotsp_k})\\&amp;=n\prod_{i=1}^{k} (1-\frac{1}{p_i})\end{aligned}\]</span></p><h2 id="section-5">33</h2><blockquote><figure><img src="/images/image-20240824225321055.png"alt="image-20240824225321055" /><figcaption aria-hidden="true">image-20240824225321055</figcaption></figure></blockquote><p>等价于从围成一圈的<spanclass="math inline">\(1,2,\cdots,2n\)</span>选择不相邻的<spanclass="math inline">\(m\)</span>个数字。我们选出分成<spanclass="math inline">\(2n-k\)</span>和<spanclass="math inline">\(k\)</span>，从<spanclass="math inline">\(2n-k\)</span>中选出<spanclass="math inline">\(k\)</span>个空，每一种选择可进行旋转，有<spanclass="math inline">\(\frac{2n}{2n-k}\)</span>种。所以 <spanclass="math display">\[a(n,k)=\frac{2n}{2n-k} \binom{2n-k}{k}\]</span> 或者：</p><p>若不考虑<spanclass="math inline">\(1，2n\)</span>，我们可以假设选择<spanclass="math inline">\(c_1,c_2,\cdots,c_k\)</span>，其中小于<spanclass="math inline">\(c_i\)</span>的有<spanclass="math inline">\(x_i\)</span>个，大于<spanclass="math inline">\(c_k\)</span>的有<spanclass="math inline">\(x_{k+1}\)</span>个。那么我们有 <spanclass="math display">\[x_1+x_2+\cdots +x_{k+1}=2n-k\]</span> 然后先在两两中间插入一个，转化为 <span class="math display">\[y_1+y_2+\cdots+y_{k+1}=2n-2k+1\]</span> 其中<span class="math inline">\(0\leq y_i\leq 2n-2k+1\)</span>，有<span class="math inline">\(\binom{2n-k+1}{k}\)</span></p><p>假设选择<span class="math inline">\(2n\)</span>，那么 不能选择<spanclass="math inline">\(1,2n-1\)</span>,有<spanclass="math inline">\(\binom{2n-k-1}{k-1}\)</span></p><p>若不选择<span class="math inline">\(2n\)</span>，那么有<spanclass="math inline">\(\binom{2n-k}{k}\)</span></p><p>总数为 <span class="math display">\[\binom{2n-k-1}{k-1}+\binom{2n-k}{k}=\frac{k}{2n-k}\binom{2n-k}{k}+\binom{2n-k}{k}=\frac{2n}{2n-k}\binom{2n-k}{k}\]</span></p><blockquote><p>不知道为什么棋盘和下面的等价，带入k=1，显然是错的，可能是这些位置不是禁止，而是其他位置禁止，那么就显然等价了。</p><p>我们可以进行编号。例如：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">1200</span><br><span class="hljs-number">0340</span><br><span class="hljs-number">0056</span><br><span class="hljs-number">8007</span><br></code></pre></td></tr></table></figure></blockquote><h2 id="section-6">34</h2><blockquote><figure><img src="/images/image-20240824225329592.png"alt="image-20240824225329592" /><figcaption aria-hidden="true">image-20240824225329592</figcaption></figure></blockquote><p>交换求和次序即可。 <span class="math display">\[\begin{aligned}f*(g*h)(x,y)&amp;=\sum_{x\leq z\leq y}f(x,z)(g*h)(z,y)\\&amp;=\sum_{x\leq z\leq y}\left( f(x,z)\left(\sum_{z\leq w\leqy}g(z,w)h(w,y) \right)\right)\\&amp;=\sum_{x\leq z\leq y} \left(\sum_{z\leq w\leq y}f(x,z)g(z,w)h(w,y)\right)\\&amp;=\sum_{x\leq w\leq y}\left(\sum_{x\leq z\leq w}f(x,z)g(z,w)\right)h(w,y)\\&amp;=\sum_{x\leq w\leq y}(f*g)(x,w)h(w,y)\\&amp;=(f*g)*h\end{aligned}\]</span></p><h2 id="section-7">36</h2><blockquote><figure><img src="/images/image-20240824225335976.png"alt="image-20240824225335976" /><figcaption aria-hidden="true">image-20240824225335976</figcaption></figure></blockquote><p>代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a[<span class="hljs-number">30</span>][<span class="hljs-number">30</span>];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span> </span>&#123;<br>  <span class="hljs-type">int</span> n;<br>  cin &gt;&gt; n;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; ++j) &#123;<br>      cin &gt;&gt; a[i][j];<br>    &#125;<br>  &#125;<br>  ll ans = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; (<span class="hljs-number">1ll</span> &lt;&lt; n); ++i) &#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; S;<br>    <span class="hljs-comment">// subset S</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; n; ++j) &#123;<br>      <span class="hljs-keyword">if</span> (i &gt;&gt; j &amp; <span class="hljs-number">1</span>) &#123;<br>        S.<span class="hljs-built_in">push_back</span>(j + <span class="hljs-number">1</span>);<br>      &#125;<br>    &#125;<br>    ll p = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; ++k) &#123;<br>      ll sum = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; x : S) sum += a[k][x];<br>      p *= sum;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ((n - S.<span class="hljs-built_in">size</span>()) &amp; <span class="hljs-number">1</span>) &#123;<br>      ans -= p;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      ans += p;<br>    &#125;<br>  &#125;<br>  cout &lt;&lt; ans;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="section-8">37</h2><blockquote><figure><img src="/images/image-20240824225341561.png"alt="image-20240824225341561" /><figcaption aria-hidden="true">image-20240824225341561</figcaption></figure></blockquote><p>赋值法。</p><p>设<span class="math inline">\(f*g=\delta\)</span> <spanclass="math display">\[\delta(A,B)=\sum_{A\subseteq C \subseteq B} f(A,C) g(C,B)\]</span></p><ul><li><p>若<span class="math inline">\(A=B\)</span>：</p><p>那么 <span class="math display">\[f(A,A)g(A,A)=1\Rightarrow g(A,A)=1\]</span> <span class="math inline">\(g(A,B)=1\)</span></p></li><li><p>若<span class="math inline">\(|B|-|A|=1\)</span></p><p>那么 <span class="math display">\[\begin{aligned}0&amp;=f(A,A)g(A,B)+f(A,B)g(B,B)\\&amp;=g(A,B)+2\end{aligned}\]</span> <span class="math inline">\(g(A,B)=-2\)</span></p></li><li><p>若<span class="math inline">\(|B|-|A|=2\)</span></p><p>那么 <span class="math display">\[\begin{aligned}0&amp;=f(A,A)g(A,B)+f(A,C)g(C,B)+f(A,B)g(B,B) \\&amp;=g(A,B)+2g(C,B)+1\\&amp;=g(A,B)-4+1\end{aligned}\]</span> <span class="math inline">\(g(A,B)=3\)</span></p></li><li><p>若<span class="math inline">\(|B|-|A|=3\)</span></p><p>那么 <span class="math display">\[\begin{aligned}0&amp;=f(A,A)g(A,B)+f(A,C)g(C,B)+f(A,D)g(D,B)+f(A,B)g(B,B) \\&amp;=g(A,B)+2g(C,B)+g(D,B)-1 \\&amp;=g(A,B)+6-2-1\\\end{aligned}\]</span> <span class="math inline">\(g(A,B)=-3\)</span></p></li></ul><p>综上</p><p>若<span class="math inline">\(A\subseteq B\)</span> <spanclass="math display">\[g(A,B)=\begin{cases}1&amp;\qquad,A=B\\-2&amp;\qquad,|B|-|A|=1\\3&amp;\qquad,|B|-|A|=2\\-3&amp;\qquad,|B|-|A|=3\end{cases}\]</span></p><h2 id="section-9">38</h2><blockquote><figure><img src="/images/image-20240824225346059.png"alt="image-20240824225346059" /><figcaption aria-hidden="true">image-20240824225346059</figcaption></figure></blockquote><p>以<span class="math inline">\(\Pi_3\)</span>为例： <spanclass="math display">\[\begin{aligned}\sigma_1&amp;=\{\{ 1,2,3\}\}\\\sigma_2&amp;=\{\{ 1\},\{ 2,3\}\}\\\sigma_3&amp;=\{\{ 1,2\},\{ 3\}\}\\\sigma_4&amp;=\{\{ 1,3\},\{ 2\}\}\\\sigma_5&amp;=\{\{ 1\},\{ 2\},\{3\}\}\\\end{aligned}\]</span></p><ul><li><p>若<span class="math inline">\(|\sigma|-|\pi|=1\)</span> <spanclass="math display">\[\begin{aligned}\mu(\sigma,\pi)=-\left(\mu(\sigma,\sigma )\right)=-1\end{aligned}\]</span></p></li><li><p>若<span class="math inline">\(|\sigma|-|\pi|=2\)</span> <spanclass="math display">\[\mu(\sigma,\pi)=-\left(\mu(\sigma,\sigma)+\mu(\sigma,\sigma_2)+\mu(\sigma,\sigma_3)+\mu(\sigma,\sigma_4)\right)=-(1-3)=2\]</span></p></li></ul><h2 id="section-10">39</h2><blockquote><figure><img src="/images/image-20240824225352287.png"alt="image-20240824225352287" /><figcaption aria-hidden="true">image-20240824225352287</figcaption></figure></blockquote><p>等价于证明<span class="math inline">\(\forall a\in X_n,\mu(1,k)=\mu(a,ka)\)</span>对任意正整数成立(满足<spanclass="math inline">\(ka\leq n\)</span>)</p><p>考虑使用数学归纳法</p><ul><li><p><span class="math inline">\(k=1\)</span>,显然成立</p></li><li><p>假设对于任意<span class="math inline">\(x\leq t-1\)</span>成立。<span class="math display">\[\begin{aligned}\mu(1,t)&amp;=-\sum_{x|t,x&lt;t}\mu(1,x)\\&amp;=-\sum_{x|t,x&lt;t}\mu(a,xa)\\&amp;=\mu(a,ta)\end{aligned}\]</span></p></li></ul><p>证毕。</p><h2 id="section-11">40</h2><blockquote><figure><img src="/images/image-20240824225358425.png"alt="image-20240824225358425" /><figcaption aria-hidden="true">image-20240824225358425</figcaption></figure></blockquote><p>这里略过证明偏序关系的过程。</p><p>这个偏序集是<spanclass="math inline">\(k\)</span>个线性有序集的笛卡尔积。因此可以得到</p><p>设<span class="math inline">\(A=p_i\cdot a_i\)</span>，<spanclass="math inline">\(B=q_i\cdot a_i\)</span>，<spanclass="math inline">\(A\leq B\)</span>，<spanclass="math inline">\(m=\max_{1\leq i \leq k}{(q_i-p_i)}\)</span>，<spanclass="math inline">\(c=\sum_{1\leq i\leq k}[q_i-p_i=1]\)</span> <spanclass="math display">\[\mu(A,B)=\begin{cases}1&amp;\qquad,m=0\\(-1)^c&amp;\qquad,m=1\\0&amp;\qquad,m&gt;1\end{cases}\]</span></p>]]></content>
    
    
    
    <tags>
      
      <tag>combinatorics</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
